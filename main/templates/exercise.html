{% extends "header.html" %}
{% block content %}
  {% load staticfiles %}
  <a href="/course/{{ course.id }}"><b>{{ course.course_name }}</b></a>
  <a href="/course/{{ course.id }}/topic/{{ topic.id }}"><b><i class="material-icons">keyboard_arrow_right</i> {{ topic.topic_name }}</b></a>
  <h3> <i class="material-icons" style="vertical-align:middle">keyboard_arrow_right</i> {{ exercise.exercise_name }}</h3>
  <br>
  <center>
  {% autoescape off %}
  {{prompt}}
  {% endautoescape %}
  <br><br> 
  Your answer : <br>
  {% if input_method == "MathKeyboard" %}
    <div id="wrap">
      <div id="mathquill"></div>
    </div>
  {% endif %}
    {% autoescape off %}
  {{ answer }}
   {% endautoescape %}
 <br>
  <form id="answer-form" method="POST">
    {% csrf_token %}
    {{ form }}
    <input class="btn btn-success" type="submit" value="Check Answer" /> &nbsp;
    <button class="btn btn-info" type="button" id="display-solution">Display solution</button> &nbsp;
    <input class="btn btn-danger" name="new" type="submit" value="New Problem" />
  </form>
  </center>
   <br>
<!--   Solution : <br><script type="math/tex; mode=display">{{diff}}</script>
 -->  <br>
<!--   Steps : <br>
  {% autoescape off %}
  <div class="steps">{{diff_steps}}</div>
  {% endautoescape %}
 -->
 <!--  <br>
  Integral :   <br>{{integral}}
 -->

 <div id="keyboard-wrapper">
 <ul id="keyboard">
    <li class="symbol" data-action="write" data-content="1">1</li>
    <li class="symbol" data-action="write" data-content="2">2</li>
    <li class="symbol" data-action="write" data-content="3">3</li>
    <li class="symbol" data-action="write" data-content="4">4</li>
    <li class="symbol" data-action="write" data-content="5">5</li>
    <li class="symbol" data-action="write" data-content="6">6</li>
    <li class="symbol" data-action="write" data-content="7">7</li>
    <li class="symbol" data-action="write" data-content="8">8</li>
    <li class="symbol" data-action="write" data-content="9">9</li>
    <li class="symbol" data-action="write" data-content="0">0</li>
    <li class="letter" data-action="write" data-content="x">x</li>
    <li class="letter" data-action="write" data-content="y">y</li>
    <li class="letter" data-action="write" data-content="z">z</li>
<!--     <li class="letter" data-action="write" data-content="\lim_{x\to\infty}">lim</li>
    <li class="letter" data-action="cmd" data-content="\ge">≥</li>
    <li class="letter" data-action="cmd" data-content="\le">≤</li>
    <li class="letter" data-action="cmd" data-content=">">></li>
    <li class="letter" data-action="cmd" data-content="<"><</li>
    <li class="letter lastitem" data-action="cmd" data-content="\infty">&#x221e;</li>
 --> 
    <li class="letter" data-action="write" data-content="+">+</li>
    <li class="letter" data-action="write" data-content="-">-</li>
    <li class="letter" data-action="write" data-content="*">*</li>
    <li class="letter" data-action="write" data-content="\frac {} {}">/</li>
    <li class="letter lastitem" data-action="cmd" data-content="^">^</li>
    <li class="letter" data-action="cmd" data-content="\sqrt">√</li>
    <li class="letter" data-action="write" data-content="[">[</li>
    <li class="letter" data-action="write" data-content="]">]</li>
    <li class="letter" data-action="write" data-content="(">(</li>
    <li class="letter" data-action="write" data-content=")">)</li>
    <li class="letter" data-action="write" data-content=".">.</li>
    <li class="letter" data-action="keystroke" data-content="Left"><i class="material-icons">keyboard_arrow_left</i></li>
    <li class="letter" data-action="keystroke" data-content="Right"><i class="material-icons">keyboard_arrow_right</i></li>
    <li class="letter" data-action="keystroke" data-content="Up"><i class="material-icons">keyboard_arrow_up</i></li>
    <li class="letter" data-action="keystroke" data-content="Down"><i class="material-icons">keyboard_arrow_down</i></li>
    <li class="letter" data-action="cmd" data-content="\pi">&pi;</li>
    <li class="letter" data-action="cmd" data-content="\sin">sin</li>
    <li class="letter" data-action="cmd" data-content="\cos">cos</li>
    <li class="letter" data-action="cmd" data-content="\tan">tan</li>
    <li class="letter" data-action="cmd" data-content="\cot">cot</li>
    <li class="letter" data-action="cmd" data-content="\sec">sec</li>
    <li class="letter" data-action="cmd" data-content="\csc">csc</li>
    <li class="letter" data-action="cmd" data-content="\arcsin">asin</li>
    <li class="letter" data-action="cmd" data-content="\arccos">acos</li>
    <li class="letter" data-action="cmd" data-content="\arctan">atan</li>
    <li class="letter" data-action="cmd" data-content="\arccot">acot</li>
    <li class="letter" data-action="cmd" data-content="\arcsec">asec</li>
    <li class="letter" data-action="cmd" data-content="\arccsc">acsc</li>
<!--     <li class="letter" data-action="cmd" data-content="\sinh">sinh</li>
    <li class="letter" data-action="cmd" data-content="\cosh">cosh</li>
    <li class="letter" data-action="cmd" data-content="\tanh">tanh</li>
    <li class="letter" data-action="cmd" data-content="\sech">sech</li>
    <li class="letter" data-action="cmd" data-content="\csch">csch</li>
    <li class="letter" data-action="cmd" data-content="\coth">coth</li> -->
    <li class="letter" data-action="write" data-content="e^{}">e</li>
    <li class="letter" data-action="write" data-content="\ln">ln</li>
    <li class="delete" data-action="keystroke" data-content="Backspace">delete</li>
  </ul>
  </div>
  <div id="keyboard-mask">
  </div>
<script>
$(document).ready(function() {
  var MQElement = document.getElementById('mathquill');

  var MQ = MathQuill.getInterface(2); // for backcompat

  var mathField = MQ.MathField(MQElement, {});

  $('#keyboard li').click( function(event) {
    event.preventDefault();
    if ( $(this).data('action') == 'write') {
      mathField.write($(this).data('content'));
    } else if($(this).data('action') == 'cmd') {
      mathField.cmd($(this).data('content'));
    } else if($(this).data('action') == 'keystroke') {
      mathField.keystroke($(this).data('content'));
    }
    mathField.focus();
  });

  $('#keyboard-mask').height($('#keyboard-wrapper').height());

  $('#answer-form').submit(function(event) {
    // event.preventDefault();
    $("#id_answer").val(mathField.latex());
    return;
  });

  $('#display-solution').click(function(e){
    e.preventDefault();
    // alert(mathField.latex());
    $(this).text($(this).text()=="Hide Solution"?"Display Solution":"Hide Solution");
    $('#solution').slideToggle();
  });
  mathField.latex($("#id_answer").val());
});
</script>
{% endblock %}